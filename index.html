<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="/main.css">
    <meta charset="utf-8">
    <title>Fuzzy Memory</title>
  </head>


  <body>

    <button class='start_button' type="button" name="button">Start New Game</button>

    <div class="board">

    </div>

    <script type="text/javascript">


    // TODO:
    // 5. Make sure you can't click when cards are turned (stresstest)
    // 6. Create difficulty settings
    // 7. Add shuffle animation

    const cards = ['A', 'A', 'B', 'B', 'C', 'C', 'D', 'D', 'E', 'E', 'F', 'F', 'G', 'G', 'H', 'H']
    const board = document.querySelector('.board')
    const start = document.querySelector('.start_button');
    const compare_array = []
    var click_counter = 0;
    var turn_counter = 0;


    // When the start button is clicked the board is cleared and a function sorts all the cards randomly.
    start.addEventListener('click', (event) => {
      board.innerHTML = " ";             // Clears board
      cards.sort(function(a, b) {        // Sorts the cards array in a random order
        return 0.5 - Math.random()
      });

      // This loops through the card array and creates a new card for each element, each consisting of a container a front and a back. We also use dataset to give each card a letter from the array so we can easily style each cards back and compare the cards later.
      cards.forEach((card) => {

        const card_container = document.createElement('div');       // Creates the divs
        card_container.classList.add('card_container');             // Adds the class .card_container
        card_container.dataset.letter = card;                       // Sets data-letter
        board.appendChild(card_container);                          // Appends to .board element

        const card_div_front = document.createElement('div');       // Creates the divs
        card_div_front.classList.add('card_front');                 // Adds the class .card_front
        card_container.appendChild(card_div_front);                 // Appends to .card_container element

        const card_div_back = document.createElement('div');        // Creates the divs
        card_div_back.classList.add('card_back');                   // Adds the class .card_back
        card_div_back.dataset.letter = card;                        // Sets data-letter
        card_container.appendChild(card_div_back);                  // Appends to .card_container element
      })

      // When a card is clicked we toggle the class of that card to make them flip over with an animation. The animation is specified in main.css.
      const rendered_cards = document.querySelectorAll('.card_container');

      Array.from(rendered_cards).forEach((card) => {
        card.addEventListener('click', (e) => {

          const card_front_flipped = e.target.querySelector('.card_front');
          card_front_flipped.classList.add('card_front_flipped');          // Changes .card_front to .card_front_flipped

          const card_back_flipped = e.target.querySelector('.card_back');
          card_back_flipped.classList.add('card_back_flipped');            // Changes .card_back to .card_back_flipped

          const data_letter = e.target.getAttribute('data-letter');

          click_counter++;                                                // Adds 1 to click_counter variable

          console.log(click_counter);

          if (click_counter == 2) {
            turn_counter++;
            console.log('turn_counter is at',turn_counter);
          }

          if (compare_array.length < 6) {

              compare_array.push(data_letter, card_front_flipped, card_back_flipped);

              console.log(compare_array);

          }

          if (compare_array.length == 6) {

            console.log(compare_array);

            if (compare_array[0] == compare_array[3]) {

              compare_array.length = 0;

              click_counter = 0;

              console.log(click_counter);
              console.log(compare_array);
            }

            if (compare_array[0] != compare_array[3] && click_counter == 3)  {

              console.log(compare_array);

              compare_array[1].classList.remove('card_front_flipped');
              compare_array[2].classList.remove('card_back_flipped');
              compare_array[4].classList.remove('card_front_flipped');
              compare_array[5].classList.remove('card_back_flipped');

              compare_array.length = 0;

              click_counter = 0;
              click_counter++;
              console.log(click_counter);

              console.log(compare_array);

              compare_array.push(data_letter, card_front_flipped, card_back_flipped);
              console.log(compare_array);

            }
          }

          })
        })
      })


      //   if (compare_array.length == 2) {
      //     const compare = (compare_array[0] == compare_array[1]) ? "Match":"No Match";
      //     console.log(compare);
      //
      //
      //   if (compare_array[0] == 'Match') {
      //     compare_array.length = 0;
      //   }
      //
      //   else  {
      //
      //     setTimeout(function(){
      //       compare_array[0].classList.remove('card_back_flipped');
      //       compare_array[1].classList.remove('card_front_flipped');
      //       compare_array[0].classList.remove('card_front_flipped');
      //       compare_array[1].classList.remove('card_back_flipped');
      //       compare_array.length = 0;
      //       console.log(compare_array);
      //     }, 1000);
      //
      //   }
      //
      //
      // }

    </script>




  </body>

</html>
